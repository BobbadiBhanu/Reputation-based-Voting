<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voting Power System</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    animation: {
                        'gradient': 'gradient 6s ease infinite',
                        'float': 'float 3s ease-in-out infinite',
                        'pulse-slow': 'pulse 3s ease-in-out infinite',
                    },
                    keyframes: {
                        gradient: {
                            '0%, 100%': { 'background-position': '0% 50%' },
                            '50%': { 'background-position': '100% 50%' },
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0px)' },
                            '50%': { transform: 'translateY(-10px)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .gradient-bg {
            background: linear-gradient(-45deg, #6366f1, #8b5cf6, #ec4899, #f59e0b);
            background-size: 400% 400%;
        }
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .glow {
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.3);
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Mock data for demonstration (replace with actual Aptos integration)
        const mockVoterData = {
            totalVotesCast: 12,
            participationScore: 12,
            lastVoteRound: 15,
            votingPower: 220,
            isRegistered: true
        };
        
        const mockSystemData = {
            currentRound: 16,
            baseVotingPower: 100,
            participationMultiplier: 10,
            totalVoters: 1247,
            totalVotesCast: 8943
        };

        // Components
        const StatsCard = ({ title, value, subtitle, icon: Icon, color = "indigo" }) => {
            const colorClasses = {
                indigo: "from-indigo-500 to-purple-600",
                emerald: "from-emerald-500 to-teal-600",
                rose: "from-rose-500 to-pink-600",
                amber: "from-amber-500 to-orange-600"
            };

            return (
                <div className="glass rounded-xl p-6 hover:scale-105 transition-all duration-300 glow">
                    <div className="flex items-center justify-between">
                        <div>
                            <p className="text-gray-300 text-sm">{title}</p>
                            <p className={`text-3xl font-bold bg-gradient-to-r ${colorClasses[color]} bg-clip-text text-transparent`}>
                                {value}
                            </p>
                            {subtitle && <p className="text-xs text-gray-400 mt-1">{subtitle}</p>}
                        </div>
                        <div className={`p-3 rounded-lg bg-gradient-to-r ${colorClasses[color]} animate-float`}>
                            <Icon size={24} className="text-white" />
                        </div>
                    </div>
                </div>
            );
        };

        const VotingInterface = ({ onVote, isLoading }) => {
            const [selectedOption, setSelectedOption] = useState('');
            
            const voteOptions = [
                { id: 'proposal-1', title: 'Governance Proposal #001', description: 'Increase base voting power to 150' },
                { id: 'proposal-2', title: 'Governance Proposal #002', description: 'Implement decay mechanism for inactive voters' },
                { id: 'proposal-3', title: 'Governance Proposal #003', description: 'Add delegation features to voting system' }
            ];

            return (
                <div className="glass rounded-xl p-6">
                    <h3 className="text-2xl font-bold mb-6 flex items-center">
                        <lucide.Vote className="mr-3 text-indigo-400" size={28} />
                        Cast Your Vote
                    </h3>
                    
                    <div className="space-y-4 mb-6">
                        {voteOptions.map((option) => (
                            <div
                                key={option.id}
                                className={`p-4 rounded-lg border-2 cursor-pointer transition-all duration-300 ${
                                    selectedOption === option.id
                                        ? 'border-indigo-500 bg-indigo-500/20 glow'
                                        : 'border-gray-600 hover:border-gray-500 bg-gray-800/50'
                                }`}
                                onClick={() => setSelectedOption(option.id)}
                            >
                                <div className="flex items-center">
                                    <div className={`w-4 h-4 rounded-full border-2 mr-3 ${
                                        selectedOption === option.id ? 'bg-indigo-500 border-indigo-500' : 'border-gray-500'
                                    }`} />
                                    <div>
                                        <h4 className="font-semibold">{option.title}</h4>
                                        <p className="text-sm text-gray-400">{option.description}</p>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>

                    <button
                        onClick={() => onVote(selectedOption)}
                        disabled={!selectedOption || isLoading}
                        className={`w-full py-4 px-6 rounded-lg font-bold text-lg transition-all duration-300 ${
                            selectedOption && !isLoading
                                ? 'bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 glow'
                                : 'bg-gray-700 cursor-not-allowed'
                        }`}
                    >
                        {isLoading ? (
                            <div className="flex items-center justify-center">
                                <div className="animate-spin rounded-full h-6 w-6 border-b-2 border-white mr-2"></div>
                                Processing Vote...
                            </div>
                        ) : (
                            'Submit Vote'
                        )}
                    </button>
                </div>
            );
        };

        const WalletConnection = ({ isConnected, onConnect, address }) => {
            if (isConnected) {
                return (
                    <div className="flex items-center space-x-4 glass rounded-lg px-4 py-2">
                        <div className="w-3 h-3 bg-green-500 rounded-full animate-pulse-slow"></div>
                        <span className="text-sm text-gray-300">
                            {address ? `${address.slice(0, 8)}...${address.slice(-6)}` : 'Connected'}
                        </span>
                    </div>
                );
            }

            return (
                <button
                    onClick={onConnect}
                    className="bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 px-6 py-3 rounded-lg font-semibold transition-all duration-300 glow"
                >
                    Connect Wallet
                </button>
            );
        };

        const ParticipationChart = ({ voterData }) => {
            const progressPercentage = Math.min((voterData.participationScore / 50) * 100, 100);
            
            return (
                <div className="glass rounded-xl p-6">
                    <h3 className="text-xl font-bold mb-4 flex items-center">
                        <lucide.TrendingUp className="mr-3 text-emerald-400" size={24} />
                        Participation Progress
                    </h3>
                    
                    <div className="relative">
                        <div className="w-full bg-gray-700 rounded-full h-4 mb-4">
                            <div 
                                className="bg-gradient-to-r from-emerald-500 to-teal-600 h-4 rounded-full transition-all duration-1000 ease-out relative overflow-hidden"
                                style={{ width: `${progressPercentage}%` }}
                            >
                                <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-gradient"></div>
                            </div>
                        </div>
                        <p className="text-center text-gray-300">
                            Level {Math.floor(voterData.participationScore / 10) + 1} Voter
                        </p>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [isConnected, setIsConnected] = useState(false);
            const [voterData, setVoterData] = useState(mockVoterData);
            const [systemData, setSystemData] = useState(mockSystemData);
            const [isLoading, setIsLoading] = useState(false);
            const [walletAddress, setWalletAddress] = useState('0xa7e0942609e060f5245db1d84c48c58c7f382cb3b18397bd2fc6184161f456ea');

            const connectWallet = async () => {
                // TODO: Implement Aptos wallet connection
                try {
                    setIsLoading(true);
                    // Simulate connection delay
                    await new Promise(resolve => setTimeout(resolve, 1500));
                    setIsConnected(true);
                    setWalletAddress('0xa7e0942609e060f5245db1d84c48c58c7f382cb3b18397bd2fc6184161f456ea');
                } catch (error) {
                    console.error('Failed to connect wallet:', error);
                } finally {
                    setIsLoading(false);
                }
            };

            const handleVote = async (selectedOption) => {
                if (!selectedOption) return;
                
                try {
                    setIsLoading(true);
                    // TODO: Call your smart contract's cast_vote function
                    console.log('Voting for:', selectedOption);
                    
                    // Simulate transaction
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    
                    // Update voter data (simulate post-vote state)
                    setVoterData(prev => ({
                        ...prev,
                        totalVotesCast: prev.totalVotesCast + 1,
                        participationScore: prev.participationScore + 1,
                        votingPower: prev.votingPower + 10,
                        lastVoteRound: systemData.currentRound
                    }));
                    
                    setSystemData(prev => ({
                        ...prev,
                        currentRound: prev.currentRound + 1
                    }));
                    
                    alert('Vote cast successfully! Your voting power has increased.');
                } catch (error) {
                    console.error('Failed to cast vote:', error);
                    alert('Failed to cast vote. Please try again.');
                } finally {
                    setIsLoading(false);
                }
            };

            useEffect(() => {
                // Simulate initial connection
                setIsConnected(true);
            }, []);

            return (
                <div className="gradient-bg animate-gradient min-h-screen">
                    <div className="container mx-auto px-4 py-8">
                        {/* Header */}
                        <header className="flex justify-between items-center mb-12">
                            <div className="flex items-center space-x-4">
                                <div className="w-12 h-12 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full flex items-center justify-center animate-float">
                                    <lucide.Users className="text-white" size={24} />
                                </div>
                                <div>
                                    <h1 className="text-4xl font-bold bg-gradient-to-r from-white to-gray-300 bg-clip-text text-transparent">
                                        Voting Power System
                                    </h1>
                                    <p className="text-gray-400">Earn influence through participation</p>
                                </div>
                            </div>
                            <WalletConnection 
                                isConnected={isConnected} 
                                onConnect={connectWallet} 
                                address={walletAddress}
                            />
                        </header>

                        {/* Stats Grid */}
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                            <StatsCard
                                title="Your Voting Power"
                                value={voterData.votingPower}
                                subtitle="Based on participation"
                                icon={lucide.Zap}
                                color="indigo"
                            />
                            <StatsCard
                                title="Votes Cast"
                                value={voterData.totalVotesCast}
                                subtitle="Historical participation"
                                icon={lucide.CheckCircle}
                                color="emerald"
                            />
                            <StatsCard
                                title="Current Round"
                                value={systemData.currentRound}
                                subtitle="Voting session"
                                icon={lucide.Clock}
                                color="amber"
                            />
                            <StatsCard
                                title="Total Voters"
                                value={systemData.totalVoters.toLocaleString()}
                                subtitle="Community size"
                                icon={lucide.Users}
                                color="rose"
                            />
                        </div>

                        {/* Main Content */}
                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                            <div className="lg:col-span-2">
                                <VotingInterface onVote={handleVote} isLoading={isLoading} />
                            </div>
                            <div className="space-y-6">
                                <ParticipationChart voterData={voterData} />
                                
                                <div className="glass rounded-xl p-6">
                                    <h3 className="text-xl font-bold mb-4 flex items-center">
                                        <lucide.Info className="mr-3 text-blue-400" size={24} />
                                        System Info
                                    </h3>
                                    <div className="space-y-3 text-sm">
                                        <div className="flex justify-between">
                                            <span className="text-gray-400">Base Power:</span>
                                            <span>{systemData.baseVotingPower}</span>
                                        </div>
                                        <div className="flex justify-between">
                                            <span className="text-gray-400">Multiplier:</span>
                                            <span>{systemData.participationMultiplier}x</span>
                                        </div>
                                        <div className="flex justify-between">
                                            <span className="text-gray-400">Last Vote Round:</span>
                                            <span>{voterData.lastVoteRound}</span>
                                        </div>
                                        <div className="flex justify-between">
                                            <span className="text-gray-400">Total Votes Cast:</span>
                                            <span>{systemData.totalVotesCast.toLocaleString()}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>